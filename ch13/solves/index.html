
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>第一套题目与题解 - Chinaskills</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.472b142f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.08040f6c.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="None" data-md-color-accent="None">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="Chinaskills" class="md-header__button md-logo" aria-label="Chinaskills" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Chinaskills
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              第一套题目与题解
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/panxiao81/Chinaskills-Debian" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    panxiao81/Chinaskills-Debian
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Chinaskills" class="md-nav__button md-logo" aria-label="Chinaskills" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Chinaskills
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/panxiao81/Chinaskills-Debian" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    panxiao81/Chinaskills-Debian
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        本书简介
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../intro/" class="md-nav__link">
        Debian 简介
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../diff-with-redhat/" class="md-nav__link">
        与 RedHat 系的主要区别
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">
        安装
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          基础配置
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="基础配置" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          基础配置
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/" class="md-nav__link">
        本章前言
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch5/network/" class="md-nav__link">
        网络
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch5/user/" class="md-nav__link">
        本地用户
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch5/ntp/" class="md-nav__link">
        时间同步
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch5/sudo/" class="md-nav__link">
        sudo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch5/mount/" class="md-nav__link">
        挂载点
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          软件包
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="软件包" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          软件包
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../package/" class="md-nav__link">
        本章前言
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch6/deb/" class="md-nav__link">
        deb 包
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch6/dpkg/" class="md-nav__link">
        包管理器 dpkg
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch6/apt/" class="md-nav__link">
        管理前端 APT
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Systemd
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Systemd" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Systemd
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../systemd/" class="md-nav__link">
        本章前言
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch7/unit/" class="md-nav__link">
        Unit 单元
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch7/target/" class="md-nav__link">
        Target 目标
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch7/timers/" class="md-nav__link">
        Timers 计时器
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch7/journal/" class="md-nav__link">
        Journal 日志
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          远程登录 SSH
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="远程登录 SSH" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          远程登录 SSH
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ssh/" class="md-nav__link">
        本章前言
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch8/basics/" class="md-nav__link">
        基本使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch8/config/" class="md-nav__link">
        修改配置
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch8/ssh-keygen/" class="md-nav__link">
        秘钥登录
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          防火墙与安全
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="防火墙与安全" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          防火墙与安全
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch9/iptables/" class="md-nav__link">
        IPtables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch9/ssl/" class="md-nav__link">
        证书认证与 OpenSSL
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          网络与网络服务
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="网络与网络服务" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          网络与网络服务
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch10/iproute2/" class="md-nav__link">
        网络工具组 iproute2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch10/vpn/" class="md-nav__link">
        虚拟专用网络
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch10/ntp/" class="md-nav__link">
        时间服务器
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch10/dhcp/" class="md-nav__link">
        DHCP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch10/dns/" class="md-nav__link">
        DNS
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_6" type="checkbox" id="__nav_10_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_6">
          邮件服务器
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="邮件服务器" data-md-level="2">
        <label class="md-nav__title" for="__nav_10_6">
          <span class="md-nav__icon md-icon"></span>
          邮件服务器
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch10/mail/" class="md-nav__link">
        邮件服务器
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch10/postfix/" class="md-nav__link">
        postfix
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch10/dovecot/" class="md-nav__link">
        Dovecot
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_7" type="checkbox" id="__nav_10_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_7">
          Web Server
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Web Server" data-md-level="2">
        <label class="md-nav__title" for="__nav_10_7">
          <span class="md-nav__icon md-icon"></span>
          Web Server
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch10/apache/" class="md-nav__link">
        Apache
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch10/nginx/" class="md-nav__link">
        nginx
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_8" type="checkbox" id="__nav_10_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_8">
          FTP Server
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="FTP Server" data-md-level="2">
        <label class="md-nav__title" for="__nav_10_8">
          <span class="md-nav__icon md-icon"></span>
          FTP Server
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch10/vsftpd/" class="md-nav__link">
        vsftpd
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch10/proftpd/" class="md-nav__link">
        proftpd
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch10/nfs/" class="md-nav__link">
        NFS Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch10/smb/" class="md-nav__link">
        SMB Server With Samba
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch10/squid/" class="md-nav__link">
        Proxy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch10/ldap/" class="md-nav__link">
        LDAP Server
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" type="checkbox" id="__nav_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_11">
          磁盘管理
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="磁盘管理" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          磁盘管理
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch11/disk/" class="md-nav__link">
        前言
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch11/partition/" class="md-nav__link">
        磁盘分区
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch11/raid/" class="md-nav__link">
        RAID
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ch11/lvm/" class="md-nav__link">
        LVM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../x11/" class="md-nav__link">
        X11
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../sdn/" class="md-nav__link">
        SDN
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14" type="checkbox" id="__nav_14" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_14">
          实验案例
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="实验案例" data-md-level="1">
        <label class="md-nav__title" for="__nav_14">
          <span class="md-nav__icon md-icon"></span>
          实验案例
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14_1" type="checkbox" id="__nav_14_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_14_1">
          实验案例
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="实验案例" data-md-level="2">
        <label class="md-nav__title" for="__nav_14_1">
          <span class="md-nav__icon md-icon"></span>
          实验案例
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/" class="md-nav__link">
        实验案例
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        第一套题目与题解
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tasks/" class="md-nav__link">
        第一套题目
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/panxiao81/Chinaskills-Debian/edit/master/docs/ch13/solves.md" title="编辑此页" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<blockquote>
<p>写在前面的小建议</p>
<p>拿到服务器首先记得修改主机名与 IP！</p>
<p>vim 使用不习惯不用强求，没人拦着你用 nano</p>
<p>如果你是 vim 用户，记得在新系统里安装好 vim 软件包：<code>vim</code> <code>vim-common</code> <code>vim-scrtpts</code> <code>ctags</code>，会加快写配置文件的时间，事半功倍</p>
<p>防火墙放在最后配置，限制 SSH 访问策略也放在最后配置，但免密登录什么时候配都可以</p>
<p>可以把所有机器的 SSH 全部打开，在 Client 上 SSH 上去配置会快一点</p>
</blockquote>
<h1 id="_1">登录</h1>
<ul>
<li>Username：root</li>
<li>Password：ChinaSkill20!</li>
<li>Username：Chinaskill20</li>
<li>Password：Chinaskill20!</li>
</ul>
<p>除特别指定外，所有账号密码均为 <code>Chinaskill20!</code></p>
<h1 id="_2">系统配置</h1>
<ul>
<li>Region：China</li>
<li>Locale：en_US.UTF-8</li>
<li>KeyMap：English US</li>
</ul>
<p>当任务为配置 SSL 或 TLS，如要求隐藏所有警告，请小心执行。</p>
<h1 id="_3">竞赛环境</h1>
<p>物理机：</p>
<p>文件夹路径：</p>
<p>虚拟机:[datastore1] ( VMware ESXi )</p>
<p>ISO 镜像：[DATA]ISO/ ( VMware ESXi )</p>
<p>软件：D:\软件 ( Host )</p>
<h1 id="_4">项目任务描述</h1>
<p>拓扑见样题</p>
<p>基本配置：</p>
<table>
<thead>
<tr>
<th>Device</th>
<th>Hostname</th>
<th>System</th>
<th>FQDN</th>
<th>IP Address</th>
<th>Service</th>
</tr>
</thead>
<tbody>
<tr>
<td>Server01</td>
<td>Server01</td>
<td>预装 Linux</td>
<td>Server01.sdskills.com</td>
<td>172.16.100.201/25</td>
<td>DNS <br> Web <br> SSH <br> LDAP <br> DBMS</td>
</tr>
<tr>
<td>Server02</td>
<td>Server02</td>
<td>待安装 Linux</td>
<td>Server02.sdskills.com</td>
<td>172.16.100.202/25</td>
<td>RAID5 <br> NFS <br> FTP <br> Mail <br> SSH <br></td>
</tr>
<tr>
<td>Server03</td>
<td>Server03</td>
<td>预装 Linux</td>
<td>Server03.skills.com</td>
<td>192.168.10.3/28</td>
<td>NTP <br> OpenVPN</td>
</tr>
<tr>
<td>Server04</td>
<td>Server04</td>
<td>待安装 Linux</td>
<td>Server04.skills.com</td>
<td>192.168.10.4/28</td>
<td>DNS <br> Web <br></td>
</tr>
<tr>
<td>Rserver</td>
<td>Rserver</td>
<td>预装 Linux</td>
<td>Rserver.sdskills.com</td>
<td>172.16.100.254/25 <br> 192.168.10.2/28 <br> 10.10.10.254/24</td>
<td>firewall <br> DHCP <br> SSH <br> CA</td>
</tr>
<tr>
<td>Client</td>
<td>Client</td>
<td>Linux Desktop</td>
<td></td>
<td>10.10.100.x</td>
<td>none</td>
</tr>
</tbody>
</table>
<p>网络：</p>
<table>
<thead>
<tr>
<th>Network</th>
<th>CIDR</th>
</tr>
</thead>
<tbody>
<tr>
<td>office</td>
<td>10.10.100.0/24</td>
</tr>
<tr>
<td>service</td>
<td>172.16.100.128/25</td>
</tr>
<tr>
<td>internet</td>
<td>192.168.10.0/28</td>
</tr>
</tbody>
</table>
<h1 id="client-task">Client Task</h1>
<p>Client 已预装简易 Debian，要求如下：</p>
<ul>
<li>要求能访问所有服务器，用于测试应用服务</li>
<li>为主机安装 GNOME 桌面环境</li>
<li>调整分辨率至 1280x768</li>
<li>测试 DHCP，IPv4 地址为自动获取</li>
<li>测试 DNS，安装 dnsutils 与 dig 命令行程序</li>
<li>测试 Web，安装 Firefox 浏览器，cUrl 命令行工具，在任何时候进行访问测试不允许弹出安全警告信息</li>
<li>测试 SSH，安装 SSH 命令行工具</li>
<li>测试 VPN 安装 VPN 客户端</li>
<li>测试 FTP，安装 FTP 客户端</li>
<li>测试文件共享，安装 Samba 命令行工具</li>
<li>测试 Mail，安装 Thunderbird，并能正常进行邮件收发</li>
<li>其他测试采用默认设定</li>
</ul>
<h2 id="_5">题解</h2>
<p>先配置主机名</p>
<pre><code class="language-sh">$ hostnamectl set-hostname client
</code></pre>
<p>并且不要忘记修改 <code>hosts</code> 文件</p>
<pre><code class="language-sh">$ vi /etc/hosts
</code></pre>
<p>默认的 vi 运行在 vi 兼容模式下，如果使用很别扭的话可安装 <code>vim</code> 软件包，或直接在 vi 中输入 <code>:set nocp</code> 关闭 vi 兼容模式。</p>
<p>将原来的主机名 <code>debian</code> 修改为新的主机名 <code>client</code></p>
<p>此题目仅安装一堆软件包即可</p>
<p>但一部分题目需要后续做完其他服务器配置后返回来进行，所以这一阶段如果 Client 作为首题只能做一部分。</p>
<p>可以先安装所需软件包：</p>
<pre><code class="language-sh">$ apt install gnome dnsutils firefox-esr curl openssh-client ftp thunderbird openvpn smbclient
</code></pre>
<p>安装完后 <code>reboot</code> 重启后进入桌面环境</p>
<pre><code class="language-sh">$ reboot
</code></pre>
<p>桌面环境默认无法使用 <code>root</code> 账户登录，使用 <code>chinaskill20</code> 可登录进入桌面环境。</p>
<p>右键选择 <code>Display Settings</code>，打开显示器设置，将分辨率改为 1280x768</p>
<p>在配置后续机型时，会回来此机配置后续项目。</p>
<h1 id="client-task_1">Client Task</h1>
<ul>
<li>要求能访问所有服务器，用于测试应用服务</li>
<li>为主机安装 GNOME 桌面环境</li>
<li>调整显示分辨率为 1280x768</li>
<li>测试 DHCP，网卡 IPv4 地址为自动获取</li>
<li>测试 DNS，安装 dnsutils 与 dig 命令行工具</li>
<li>测试 Web，安装 Firefox 浏览器，curl 命令行测试工具，在任何时候进行访问测试时不允许弹出安全警告信息</li>
<li>测试 SSH，安装 SSH 命令行工具</li>
<li>测试 VPN，安装 OPENVPN 客户端工具软件</li>
<li>测试 FTP，安装 lftp 客户端工具</li>
<li>测试文件共享，安装 smbclient 客户端工具</li>
<li>测试 Mail，安装 Thunderbird，并能正常进行邮件收发</li>
<li>其他设定均采用默认设定</li>
</ul>
<h2 id="_6">题解</h2>
<p>安装桌面环境 </p>
<pre><code class="language-sh">$ apt install gnome
</code></pre>
<p>重启即可</p>
<h1 id="rserver-task">Rserver Task</h1>
<ul>
<li>Network</li>
<li>请根据基本配置信息配置服务器主机名，网卡 IP 地址配置，域名等</li>
<li>开启路由转发功能</li>
<li>iptables</li>
<li>默认阻挡所有流量</li>
<li>添加必要的 NAT 规则，使 Office 和 Service 网络能够访问 Internet</li>
<li>添加必要的规则以满足其他服务所需，禁止创建放行所有流量的规则</li>
<li>DHCP</li>
<li>为客户端分配 IP 范围为 10.10.100.1 - 10.10.100.50</li>
<li>按照实际配置 DNS 与 GATEWAY</li>
<li>配置 Client 固定获取 IP 地址为 10.10.100.51</li>
<li>SSH</li>
<li>安装 SSH 正常监听</li>
<li>限制除 Client 以外的客户端登录，其他主机都应拒绝</li>
<li>配置 Client 只能在 Chinaskills20 用户可以免密登录，端口为 2222，且具有 root 控制权限</li>
<li>CA</li>
<li>CA 根证书路径 /CA/cacert.pem</li>
<li>签发数字证书，签发者信息<ul>
<li>国家 = CN</li>
<li>单位 = Inc</li>
<li>组织机构 = www.skills.com</li>
<li>公用名 = Skill Global Root CA</li>
</ul>
</li>
</ul>
<h2 id="_7">题解</h2>
<h3 id="network">Network</h3>
<p>首先查看网卡名称，使用 <code>ip link</code></p>
<pre><code class="language-sh">$ ip link
1: lo: (LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 
2: ens192: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000 
    link/ether 00:0c:29:a4:90:60 brd ff:ff:ff:ff:ff:ff 
2: ens224: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group DEFAULT qlen 1000 
    link/ether 00:0c:29:a4:90:Ba brd ff:ff:ff:ff:ff:ff 
4: ens256: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000 
    link/ether 00:0c:29:a4:90:94 brd ff:ff:ff:ff:ff:ff
</code></pre>
<p>共三块网卡，分别按照对应网络设定。</p>
<p>编辑 <code>/etc/network/interfaces</code></p>
<pre><code class="language-sh">$ vi /etc/network/interfaces
</code></pre>
<pre><code class="language-sh">auto ens192
iface ens192 inet static
address 172.16.100.254/25

auto ens224
iface ens224 inet static
address 10.10.100.254/24

auto ens256
iface ens256 inet static
address 192.168.10.2/28
</code></pre>
<p>接下来启用网卡</p>
<pre><code class="language-sh">$ ifup ens192 ens224 ens256
</code></pre>
<p>配置主机名</p>
<pre><code class="language-sh">$ hostnamectl set-hostname Rserver
</code></pre>
<p>修改 <code>/etc/hosts</code>,将 FQDN 写入 <code>hosts</code> 文件</p>
<p>修改 <code>127.0.1.1 debian</code> 这一行，修改为</p>
<pre><code class="language-sh">127.0.1.1 Rserver.sdskills.com Rserver
</code></pre>
<p>打开内核的 IPv4 转发，编辑 <code>/etc/sysctl.conf</code>，28 行处的 <code>net.ipv4.ip_forward=1</code> 去掉前面的注释，保存文件。</p>
<p>使配置文件生效</p>
<pre><code class="language-sh">$ sysctl -p
</code></pre>
<p>这台电脑实际上要作为拓扑中的接入路由器来使用，因此后续的网关设备全部指定此计算机</p>
<p>FQDN 在 Linux 上是通过 DNS 解析实现的，验证配置使用 <code>hostname -f</code></p>
<h2 id="iptables">iptables</h2>
<p>这道题做出来的不多，我怀疑应该是没看懂题目。</p>
<p>这个实验环境是将 <code>192.168.10.0/28</code> 网段看作公有 Internet，将 <code>service</code> 以及 <code>office</code> 接入互联网，因此应在 Rserver 配置 NAT 使其通过 Rserver 的 IP 地址接入互联网，能理解到这个程度那么做起来也就不难了。</p>
<p>iptables 配置最烦人的点就是必须按顺序将防火墙规则写进 iptables 配置中，一旦写错就要清除配置重来，不像现在的 firewalld 是并行处理的，所以实际使用的时候先全部放行，等待全部配置完成之后再来思考防火墙规则可能更好。</p>
<p>比较方便的方法是写一个配置规则的 Shell 脚本，这样后续修改起来会相对方便。</p>
<pre><code class="language-sh">#!/bin/bash

# 待补全

# 清除现有规则
iptables -F
iptables -X
iptables -Z

# 设定默认规则
iptables -P INPUT DROP
iptables -P OUTPUT DROP
iptables -P FORWARD DROP

# 设定规则
iptables -A INPUT -i lo -j ACCEPT # 放行所有本机流量
iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT # 放行状态流量
iptables -A INPUT -i ens224 -p tcp -dport 2222 -j ACCEPT # 放行 SSH 流量

</code></pre>
<h2 id="dhcp">DHCP</h2>
<p>安装软件包 <code>isc-dhcp-server</code></p>
<pre><code class="language-sh">$ apt install isc-dhcp-server
</code></pre>
<p>没有做配置的情况下，安装时会提示服务无法启动，这是正常的。</p>
<p>要修改的文件有 <code>/etc/default/isc-dhcp-server</code> 与 <code>/etc/dhcp/dhcpd.conf</code></p>
<p>首先修改 <code>/etc/default/isc-dhcp-server</code> 指定监听网卡</p>
<pre><code class="language-sh">INTERFACESv4=&quot;ens224&quot;
</code></pre>
<p>接下来编辑 <code>/etc/dhcp/dhcpd.conf</code></p>
<p>在文件 50 行处有一个写的较完整的示例配置，可以直接复制使用</p>
<pre><code class="language-sh">subnet 10.10.100.0 netmask 255.255.255.0 {
  range 10.10.100.1 10.10.100.50;
  option domain-name-servers 172.16.100.201;
  option domain-name &quot;sdskills.com&quot;;
  option routers 10.10.100.254;
  option broadcast-address 10.10.100.255;
  default-lease-time 600;
  max-lease-time 7200;
}

host client {
  hardware ethernet 00:0c:29:4c:e3:a7;
  fixed-address 10.10.100.51;
}
</code></pre>
<p>其中，client 的 MAC 地址可通过在 Client 上使用 <code>ip link</code> 查看</p>
<p>启动服务，并确保开机启动</p>
<pre><code class="language-sh">$ systemctl start isc-dhcp-server
$ systemctl enable isc-dhcp-server
</code></pre>
<h2 id="ssh">SSH</h2>
<p>每次修改配置文件时，使用 <code>systemctl reload ssh</code> 使配置生效</p>
<p>编辑 <code>/etc/ssh/sshd_config</code></p>
<p>修改 Port 为 2222</p>
<p>临时修改 PermitRootLogin 为 yes</p>
<p>拷贝 SSH key</p>
<pre><code class="language-sh"># 在 Client 上
$ ssh-keygen
# 无脑回车
$ ssh-copy-id root@10.10.100.254 -p 2222
# 先在 Rserver 端允许 Root 账户登录，后再修改回来
</code></pre>
<p>编辑 <code>/etc/hosts.deny</code> 来限制登录</p>
<pre><code class="language-sh">sshd:ALL except 10.10.100.51:deny
# 意为除去 10.10.100.51 主机以外的其他所有主机均禁止访问本机的 SSH 服务
</code></pre>
<p>确保服务开机启动</p>
<pre><code class="language-sh">$ systemctl start ssh
$ systemctl enable ssh
</code></pre>
<h2 id="ca">CA</h2>
<p>在配置 CA 之前，确保当前时间正确，时区正确，最好先配置 NTP 服务器再回来配置 CA</p>
<p>修改 <code>/usr/lib/ssl/openssl.cnf</code></p>
<p>第 28 行处，修改根目录为 <code>/CA</code></p>
<p>创建子目录：</p>
<pre><code class="language-sh">$ cd /CA
$ mkdir newcerts certs crl private
</code></pre>
<p>并创建两个文件：</p>
<pre><code class="language-sh">$ touch ./index.txt
$ echo 1000 &gt; serial
</code></pre>
<p>生成根证书私钥</p>
<pre><code class="language-sh">$ openssl genrsa -out private/cakey.pem 4096
</code></pre>
<p>使用上一步生成的私钥签发证书：</p>
<pre><code class="language-sh">$ openssl req -x509 -new -key /CA/private/cakey.pem -out /CA/cacert.pem
</code></pre>
<h1 id="server01">Server01</h1>
<h2 id="network_1">Network</h2>
<p>配置 IP 与主机名跟上面方法相同，不多赘述</p>
<h2 id="dns">DNS</h2>
<p>Debian 将 Bind 的配置文件分成了很多份</p>
<p>对于 DNS 转发器，修改 <code>/etc/bind/named.conf.options</code>,文件中有一段被注释掉的 forwarders,取消注释后修改即可</p>
<p>将正向与反向解析配置放进 <code>/etc/bind/named.conf.local</code>，如下:</p>
<pre><code class="language-sh">zone &quot;sdskills.com&quot; {
  type master;
  file &quot;/etc/bind/db.sdskills.com&quot;;
};

zone &quot;100.16.172.in-addr.aroa&quot; {
  type master;
  file &quot;/etc/bind/db.172.16.100&quot;;
};
</code></pre>
<p>不要忘记末尾的分号！</p>
<p>接下来创建区域文件，从已有的区域文件复制修改即可</p>
<pre><code class="language-sh">$ cp /etc/bind/db.local /etc/bind/db.sdskills.com
$ cp /etc/bind/db.127 /etc/bind/db.172.16.100
</code></pre>
<p>将 SOA 修改为自己的域名 ( 注意域名后的点！ )</p>
<p>添加自己需要的记录即可</p>
<p>使用 named-checkconf 和 named-checkzone 来检查语法格式是否正确</p>
<pre><code class="language-console">root@Server01:~# named-checkconf
root@Server01:~# named-checkzone sdskills.com /etc/bind/db.sdskills.com
zone sdskills.com/IN:  loaded serial 2
OK
root@Server01:~#
</code></pre>
<p>当前的 Bind 版本默认只允许本地与已知的本地局域网访问服务器进行查询，因此需要修改配置文件，改回以前的放行模式：</p>
<p>修改 <code>/etc/bind/named.conf.options</code>，在后面增加三行：</p>
<pre><code class="language-sh">options {
     ...
     allow-recursion { any; };
     allow-query { any; };
     allow-query-cache { any; };
     ...
 };
 ```

放行所有主机。

## apache

题目中需要使用 LDAP 做认证，配置完 LDAP 后再来

```sh
apt install apache2
</code></pre>
<p>新建 <code>webuser</code> 用户，指定为系统用户并禁止登录</p>
<pre><code class="language-sh">$ useradd -r webuser -s /sbin/nologin
</code></pre>
<p>修改 <code>/etc/apache2/envvars</code></p>
<p>将指定运行用户与组的变量修改</p>
<pre><code class="language-sh">export APACHE_RUN_USER=webuser
export APACHE_RUN_GROUP=webuser
</code></pre>
<p>网站目录放在 NFS 共享中，先做 Server02 再回来</p>
<p>挂载 <code>/data/share</code></p>
<p>写入 <code>/etc/fstab</code></p>
<pre><code class="language-sh">172.16.100.202:/data/share  /data/share  nfs  defaults,_netdev  0  0
</code></pre>
<pre><code class="language-sh">$ mount -a
</code></pre>
<p>写 index.sh</p>
<pre><code class="language-sh">$ mkdir /data/share/webroot
$ vim /data/share/webroot/index.sh
</code></pre>
<pre><code class="language-sh">#!/bin/bash
# This is index.sh
echo &quot;Content-type: text/html&quot;
echo &quot;&quot;
echo &quot;Current System Time is: $(date +&quot;%F %r&quot;)&quot;
</code></pre>
<p>修复目录权限，并使脚本可执行</p>
<pre><code class="language-sh">$ chown -R webuser:webuser /data/share/webroot
$ chmod 775 /data/share/webroot/index.sh
</code></pre>
<p>配置 Apahce，使 CGI 脚本可执行，并允许处理 Shell 脚本</p>
<pre><code class="language-sh">$ vim /etc/apache2/conf-enabled/security.conf
</code></pre>
<pre><code class="language-xml">&lt;Dictory &quot;/data/share/webroot&quot;&gt;
    AllowOverride None
    Options +ExecCGI -MultiViews
    AddHandler cgi-script .cgi .sh .pl
    Require all granted
&lt;/Directory&gt;
</code></pre>
<p>配置虚拟主机们，加上 SSL。</p>
<p>签发证书</p>
<pre><code class="language-sh">$ openssl req -new -key Server01.pem -out http.csr
$ openssl ca -in http.csr -out http.pem
</code></pre>
<p>将证书传回 Server01 后，修复权限并放在对应目录</p>
<pre><code class="language-sh">chmod 777 *.pem
cp http.pem /etc/ssl/certs/http_sdskills_com.pem
</code></pre>
<p>Apache 提供了 SSL 的虚拟主机模板，在 `/etc/apache2/sites-available/default-ssl.conf</p>
<p>将这个文件复制一份，然后修改</p>
<pre><code class="language-sh">cp /etc/apache2/sites-available/default-ssl.conf /etc/apache2/sites-available/www.sdskills.com.conf
vim /etc/apache2/sites-available/www.sdskills.com
</code></pre>
<p>原文件内容很多，只截取需要注意的部分</p>
<pre><code class="language-xml">&lt;VirtualHost _default_:443&gt;
    ServerName www.sdskills.com
    ServerAlias *.sdskills.com
    DocumentRoot /data/share/webroot

    SSLEngine On

    SSLCertificateFile /etc/ssl/certs/http_sdskills_com.pem
    SSLCertificateKeyFile /etc/ssl/certs/Rserver.key
&lt;/VirtualHost&gt;
</code></pre>
<p>启用 SSL 模块，启用刚才修改的网站配置文件</p>
<pre><code class="language-sh">$ a2enmod ssl
$ a2ensite www.sdskills.com.conf
</code></pre>
<p>修改原始默认网站文件，将 80 端口访问重定向到 HTTPS</p>
<pre><code class="language-sh">$ vim /etc/apache2/sites-enabled/000-default.conf
</code></pre>
<pre><code class="language-xml">&lt;VirtualHost *:80&gt;
    ServerName www.sdskills.com
    ServerAlias *.sdskills.com
    # 把原有配置注释
    # DocumentRoot /var/www/html

    # 加入
    redirect permanent / https://www.sdskills.com/
&lt;/VirtualHost&gt;
</code></pre>
<h3 id="ldap">配置 LDAP 验证</h3>
<p>修改刚才写好的 /etc/apache2/conf-enabled/security.conf</p>
<pre><code class="language-xml">&lt;Dictory &quot;/data/share/webroot&quot;&gt;
    AllowOverride None
    Options +ExecCGI -MultiViews
    AddHandler cgi-script .cgi .sh .pl
    # 增加
    AuthType basic
    AuthBasicProvider ldap
    AuthLDAPUrl &quot;ldaps://localhost/ou=People,dc=sdskills,dc=com&quot;
    AuthName LDAP
    # 注释掉这行，重写
    #Require all granted
    Require valid-user
&lt;/Directory&gt;
# 在外面增加
LDAPVerifyServerCert off
</code></pre>
<h3 id="mariadb">MariaDB</h3>
<pre><code class="language-sh">$ apt install mariadb-server
$ mysql_secure_installation
</code></pre>
<p>增加一个超级用户用于网页端管理，新版的 MariaDB 与 MySQL 已不允许用户使用 root 在命令行以外的场合登录</p>
<pre><code class="language-sh">$ mariadb -uroot -p
</code></pre>
<pre><code class="language-sql">CREATE USER '新用户'@'%' IDENTIFIED BY '新用户的密码';
GRANT ALL PRIVILEGES ON *.* TO '新用户'@'%' WITH GRANT OPTION;
</code></pre>
<p>接下来托管 phpMyAdmin 即可使用新创建的用户登录</p>
<h3 id="php">PHP</h3>
<pre><code class="language-sh">$ apt install php libapache2-mod-php php-mysql
</code></pre>
<p>托管 phpMyAdmin 需要安装 <code>php-xml</code> 模块</p>
<pre><code class="language-sh">$ apt install php-xml
$ systemctl restart apache2
</code></pre>
<p>将网站文件复制后确认权限正确</p>
<pre><code class="language-sh">$ chown -R webuser:webuser /data/share/htdocs
</code></pre>
<h2 id="ssh_1">SSH</h2>
<p>几乎同理，参照 Rserver 配置</p>
<h2 id="ldap_1">LDAP</h2>
<p>安装配置 LDAP 前，先创建好需求的 100 个用户</p>
<p>这个肯定不能手敲，所以上 Shell 脚本:</p>
<pre><code class="language-sh">#!/bin/bash
# 在一个等宽的 100 个数中循环
for i in $(seq -w 100)
do
  # 新建用户
  useradd lduser$i
  # 给用户设置密码
  echo &quot;lduser$i:Chinaskill20!&quot; | chpasswd
done
</code></pre>
<p>红帽系可以使用 <code>passwd --stdin</code> ，但 Debian 的 <code>passwd</code> 不支持这个参数，所以需要使用另一个工具 <code>chpasswd</code></p>
<p>脚本写完，保存为 useradd.sh，赋予执行权限直接运行，或者：</p>
<pre><code class="language-sh">$ bash useradd.sh
</code></pre>
<p>安装 slapd 与 migrationtools</p>
<pre><code class="language-sh">$ apt install slapd migrationtools
</code></pre>
<p>并配置 <code>slapd</code></p>
<pre><code class="language-sh">$ dpkg-reconfigure slapd
</code></pre>
<p>修改 <code>/etc/migrationtools/migrate_common.ph</code>,将原有域名改成需求的 <code>dc=sdskills,dc=com</code></p>
<p>migrationtools 脚本有一个 bug，由于 Debian 没有将文件放在该放的位置导致脚本找不到 migrate_common.ph 文件而报错。</p>
<p>进入脚本的存放目录</p>
<pre><code class="language-sh">$ cd /usr/share/migrationtools
</code></pre>
<p>修复发行版的一个 Bug，链接 <code>migrate_common.ph</code> 到 <code>/etc/perl</code></p>
<pre><code class="language-sh">$ ln -s /etc/migrationtools/migrate_common.ph /etc/perl
</code></pre>
<p>运行 <code>migrate_all_online.sh</code> 将本地信息合并进 LDAP</p>
<pre><code class="language-sh">$ LDAPADD=&quot;/usr/bin/ldapadd -c&quot; ETC_ALIASES=&quot;/dev/null&quot; ./migrate_all_online.sh
</code></pre>
<p>其中，手动指定 <code>ldapadd</code> 命令的 -c 参数使其忽略错误，根据 Debian 文档指定 ETC_ALIASES 变量来避免一个错误</p>
<table>
<thead>
<tr>
<th>Question</th>
<th>Answer</th>
</tr>
</thead>
<tbody>
<tr>
<td>X.500 naming context</td>
<td><code>dc=sdskill,dc=com</code></td>
</tr>
<tr>
<td>LDAP server hostname</td>
<td><code>localhost</code></td>
</tr>
<tr>
<td>Manager DN</td>
<td><code>cn=admin,dc=sdskill,dc=com</code></td>
</tr>
<tr>
<td>Bind credentials</td>
<td>输入密码</td>
</tr>
<tr>
<td>Create DUAConfigProfile</td>
<td>no</td>
</tr>
</tbody>
</table>
<p>生成证书私钥与证书签发请求</p>
<pre><code class="language-sh">$ openssl genrsa -out Rserver.pem 4096
$ openssl req -new -key Rserver.pem -out ldap.csr
</code></pre>
<p>在 Rserver 上给证书签名</p>
<pre><code class="language-sh">$ openssl ca -in ldap.csr -out ldap.pem
</code></pre>
<p>将证书传回 Server01</p>
<p>给证书文件赋予权限：</p>
<pre><code class="language-sh">$ chmod 777 *.pem
</code></pre>
<p>本例中所有证书存放在 <code>/root</code> 下</p>
<p>将 CA 根证书，Server01 的私钥，以及 LDAP 证书存放至 <code>/etc/ssl/certs/</code></p>
<p>配置 LDAP config，加入证书位置</p>
<pre><code class="language-sh">$ apt install ldapvi
$ ldapvi -Y EXTERNAL -h ldapi:/// -b cn=config
</code></pre>
<p>在 cn=config</p>
<pre><code class="language-sh">olcTLSCACertificateFile: /etc/ssl/certs/Skill_Root_Global_CA.pem
olcTLSCertificateKeyFile: /etc/ssl/certs/Rserver.key
olcTLSCertificateFile: /etc/ssl/certs/Rserver_ldap.pem
</code></pre>
<p>保存退出，按 <code>y</code> 确认修改</p>
<p>修改 <code>/etc/default/slapd</code> 打开 <code>ldaps://</code> 监听</p>
<pre><code class="language-sh">$ vim /etc/default/slapd
</code></pre>
<pre><code class="language-sh">SLAPD_SERVICES=&quot;ldaps:/// ldapi:///&quot;
</code></pre>
<h1 id="server02">Server02</h1>
<h2 id="network_2">Network</h2>
<p>大同小异，不再赘述</p>
<h2 id="disk-raid5">Disk ( Raid5 )</h2>
<pre><code class="language-sh">$ apt install mdadm
</code></pre>
<p>添加硬盘</p>
<pre><code class="language-sh">$ mdadm -Cv /dev/md0 -l 5 -n 3 -x 1 /dev/sdb /dev/sdc /dev/sdd /dev/sde
</code></pre>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-C</code></td>
<td>创建软件 RAID</td>
</tr>
<tr>
<td><code>-v</code></td>
<td>显示详细信息</td>
</tr>
<tr>
<td><code>-l</code></td>
<td>指定阵列类型，此处为 RAID 5</td>
</tr>
<tr>
<td><code>-n</code></td>
<td>指定使用几块硬盘，不算备份盘</td>
</tr>
<tr>
<td><code>-x</code></td>
<td>指定使用几块硬盘作为备份</td>
</tr>
</tbody>
</table>
<p>创建 LVM</p>
<pre><code class="language-sh"># 安装逻辑卷管理工具
$ apt install lvm2
# 创建卷组与逻辑卷
$ vgcreate /dev/vg01 /dev/md0
$ lvcreate -l 510 -n lv01 /dev/vg01
# 使用 ext4 格式化
$ mkfs.ext4 /dev/vg01/lv01
</code></pre>
<p>写入 /etc/fstab 实现自动挂载</p>
<pre><code class="language-sh">$ mkdir /data
$ vim /etc/fstab
</code></pre>
<p>写入</p>
<pre><code class="language-sh">$ /dev/vg01/lv01    /data    ext4    defaults    0  0
</code></pre>
<pre><code class="language-sh">$ mount -a
</code></pre>
<h2 id="nfs">NFS</h2>
<pre><code class="language-sh">apt install nfs-kernel-server
</code></pre>
<p>修改 <code>/etc/exports</code></p>
<pre><code class="language-sh">/data/share  172.16.100.128/25(rw,sync,no_subtree_check)
</code></pre>
<p>重启服务</p>
<pre><code class="language-sh">systemctl restart nfs-kernel-server
</code></pre>
<h1 id="server04">Server04</h1>
<p>关于 DNS 解析的第三问</p>
<p>DNS 根这么写</p>
<p><img alt="图 1" src="../../images/88d1d612bf415cc826d472bf4f243810109e143cf2f0fbc05a8f64f30b496d3d.png" />  </p>
<p>DNS 默认配置文件 /etc/bind/named.conf.default-zones 修改根域名部分</p>
<p>即一个点</p>
<p><img alt="图 2" src="../../images/80e6fac10d65867c6097025667963fbc700a0596be86b3b0dcd33ffc9480fe48.png" />  </p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="页脚" >
      
        
        <a href="../../labs/" class="md-footer__link md-footer__link--prev" aria-label="上一页: 实验案例" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                上一页
              </span>
              实验案例
            </div>
          </div>
        </a>
      
      
        
        <a href="../tasks/" class="md-footer__link md-footer__link--next" aria-label="下一页: 第一套题目" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                下一页
              </span>
              第一套题目
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["toc.integrate"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\s\\-\uff0c\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.d6c3db9e.min.js"></script>
      
    
  </body>
</html>